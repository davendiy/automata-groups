\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage[left=2cm,right=2cm,
    top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}
\title{AutomataGroups}
\author{davendiy }
\date{March 2020}

\begin{document}

% \maketitle

$$ T(z) = \sum_{w}size(w)z^{|w|} = \sum_{w_1}\sum_{w_2}\sum_{w_3}\left(s(w_1) + s(w_2) + s(w_3) +|w_1| + |w_2| + |w_3|\right)z^{|w_1| + |w_2| + |w_3|} =$$
$$=\sum_{w_1}\sum_{w_2}z^{|w_1| + |w_2|}\left((s(w_1) + s(w_2))\sum_{w_3}z^{|w_3|} + \sum_{w_3}s(w_3)z^{|w_3|} + (|w_1| + |w_2|)\sum_{w_3}z^{|w_3|} + \sum_{w_3}|w_3|z^{|w_3|}\right) = $$
$$= \left[\sum_{w}z^{|w|} = F(z), \quad \sum_{w}|w|z^{|w|} = z\sum_{w}|w|z^{|w| - 1} = zF'(z)\right] = $$
$$=\sum_{w_1}z^{|w_1|}\sum_{w_2}z^{|w_2|}\left((s(w_1) + s(w_2) + |w_1| + |w_2|)F(z) + T(z) + zF'(z)\right) = $$
$$ = \sum_{w_1}z^{|w_1|}\left(
			(T(z) + zF'(z))\sum_{w_2}z^{|w_2|} + F(z) \left( (s(w_1) + |w_1|)\sum_{w_2}z^{|w_2|} + \sum_{w_2}s(w_2)z^{|w_2|} + \sum_{w_2}|w_2|z^{|w_2|} \right)
\right) = $$
$$ = \sum_{w_1}z^{|w_1|} \left[ (T(z) + zF'(z))F(z) + F(z) ( (s(w_1) + |w_1|)F(z) + T(z) + zF'(z)) \right]  = $$
$$= \sum_{w_1}z^{|w_1|}\left[ T(z)F(z) + zF(z)F'(z) + F^2(z) (s(w_1) + |w_1|) + F(z)T(z) + zF(z)F'(z)   \right] = $$
$$ = \sum_{w_1}z^{|w_1|}\left[ 2T(z)F(z) + 2zF(z)F'(z) + F^2(z)(s(w_1) + |w_1|)  \right] = $$
$$ = 2T(z)F^2(z) + 2zF^2(z)F'(z) + F^2(z)T(z) + zF^2(z)F'(z) = 3T(z)F^2(z) + 3zF^2(z)F'(z)$$
$$\Rightarrow T(z) = \dfrac{3zF^2(z)F'(z)}{1 - 3F^2(z)}, \quad F(z) = \sum_{w}z^{|w|} = \sum_{n=1}^{\infty}x_n z^n$$

\begin{enumerate}
    \item $x_n = 3^n$
    $$F(z) = \sum_{n=1}^{\infty}3^nz^n = \sum_{n=1}^{\infty}(3z)^n = \dfrac{1}{1 - 3z} \quad \Rightarrow \quad T(z) = \dfrac{3z\dfrac{1}{(1 - 3z)^2} \dfrac{3}{(1 - 3z)^2}}{1 - 3\dfrac{1}{(1 - 3z)^2}} = \dfrac{9z}{81z^4 - 108z^3 + 27z^2+6z - 2} = \dfrac{P(z)}{Q(z)}$$
    Roots of Q(z): $\dfrac{1}{3}, \quad \dfrac{1}{3}, \quad \dfrac{1}{3} - \dfrac{1}{\sqrt{3}}, \quad \dfrac{1}{3} + \dfrac{1}{\sqrt{3}}$

    The root $\dfrac{1}{3} - \dfrac{1}{\sqrt{3}}$ has the least absolute value ($\sim0.24$). Thus, by theorem of asymptotic growth of the rational generative functions' coefficients

    $$[z^n] T(z) \sim C \left(\dfrac{3\sqrt{3}}{\sqrt{3} - 3}\right)^n \quad \Rightarrow \quad \dfrac{[z^n]T(z)}{3^n} \sim C \left(\dfrac{\sqrt{3}}{\sqrt{3} - 3}\right)^n$$

    \item $x_n = 3 * 2^{n-1}$
    $$F(z) = \sum_{n=1}^{\infty}3*2^{n-1}z^n = \frac{3}{2} \sum_{n=1}^{\infty}(2z)^n = \dfrac{3}{2 - 4z}, \quad \Rightarrow, \quad T(z) = \dfrac{3z \left(\dfrac{3}{2 - 4z}\right)^2 \dfrac{d}{dz}\left(\dfrac{3}{2 - 4z}\right)}{1 - 3\left(\dfrac{3}{2 - 4z}\right)^2} =$$
    $$=\dfrac{81z}{64z^4 - 128z^3 - 12z^2 + 76z - 23} = \dfrac{P(z)}{Q(z)}$$

    Roots of Q(z): $\dfrac{1}{2}, \dfrac{1}{2}, \dfrac{1}{2} - \dfrac{3\sqrt{3}}{4}, \dfrac{1}{2} + \dfrac{3\sqrt{3}}{4}$

    The root $\dfrac{1}{2}$ of multiplicity 2 has the least absolute value. Thus, by theorem of asymptotic growth of the rational generative functions' coefficients

    $$[z^n]T(z) \sim C(2)^n n, \quad C = 2 \dfrac{(-2)^2 * P(1/2)}{Q''(1/2)} = \dfrac{8 * 81/2}{24(32*1/4 - 32*1/2 - 1)} = -\dfrac{81}{42}$$

    $$\Rightarrow \quad \dfrac{[z^n]T(z)}{3*2^{n-1}} \sim \dfrac{-81 * 2^n * n}{42 * 3 * 2^{n-1}} = -\dfrac{9}{7}n$$
\end{enumerate}
\end{document}
